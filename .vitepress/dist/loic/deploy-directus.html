<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>D√©ployer Directus | Fiches Dev Web</title>
    <meta name="description" content="Dev Web tutorials">
    <meta name="generator" content="VitePress v1.3.2">
    <link rel="preload stylesheet" href="/assets/style.B7C2H_ZE.css" as="style">
    
    <script type="module" src="/assets/app.C_sU-ynl.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.7VcAq9Mr.js">
    <link rel="modulepreload" href="/assets/chunks/framework.BXMoTSpH.js">
    <link rel="modulepreload" href="/assets/loic_deploy-directus.md.tgP4OCcd.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c8291ffa></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c8291ffa> Skip to content </a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar has-sidebar top" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle has-sidebar" data-v-9fd4d1dd data-v-0ad69264><a class="title" href="/" data-v-0ad69264><!--[--><!--]--><!----><span data-v-0ad69264>Fiches Dev Web</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/index.html" tabindex="0" data-v-afb2845e data-v-08fbf4b6><!--[--><span data-v-08fbf4b6>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/menus/les_autres.html" tabindex="0" data-v-afb2845e data-v-08fbf4b6><!--[--><span data-v-08fbf4b6>Feat.</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/markdown-examples.html" tabindex="0" data-v-afb2845e data-v-08fbf4b6><!--[--><span data-v-08fbf4b6>Examples</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/lorlor31" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-358b6670><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-af5898d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-af5898d3><span class="vpi-more-horizontal icon" data-v-af5898d3></span></button><div class="menu" data-v-af5898d3><div class="VPMenu" data-v-af5898d3 data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/lorlor31" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-358b6670><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-883964e0><button data-v-883964e0>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-42c4c606><div class="curtain" data-v-42c4c606></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-42c4c606><span class="visually-hidden" id="sidebar-aria-label" data-v-42c4c606> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-edd2eed8><div class="item" role="button" tabindex="0" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><h2 class="text" data-v-edd2eed8>Examples</h2><!----></div><div class="items" data-v-edd2eed8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/markdown-examples.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Markdown Examples</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/api-examples.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Runtime API Examples</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>On this page</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _loic_deploy-directus" data-v-e6f2a212><div><h1 id="deployer-directus" tabindex="-1">D√©ployer Directus <a class="header-anchor" href="#deployer-directus" aria-label="Permalink to &quot;D√©ployer Directus&quot;">‚Äã</a></h1><blockquote><p>‚ÑπÔ∏è Tout au long de ce tutoriel, tu rencontreras des sections &quot;SPOILER&quot; que tu pourras d√©plier pour obtenir des explications sur ce que tu fais et pourquoi tu le fais.</p></blockquote><h2 id="etape-0-la-vm-server-kourou" tabindex="-1">√âtape 0 : La VM Server Kourou <a class="header-anchor" href="#etape-0-la-vm-server-kourou" aria-label="Permalink to &quot;√âtape 0 : La VM Server Kourou&quot;">‚Äã</a></h2><details><summary>SPOILER: C&#39;est quoi la VM Server Kourou ?</summary><p>Si tu dormais pendant la saison 8 du socle (ou si tu as beaucoup dormi depuis), voici un bref rappel de ce qu&#39;est la VM Server Kourou :</p><blockquote><p>O&#39;clock met √† ta disposition un serveur virtuel dans le ‚òÅÔ∏è cloud ‚òÅÔ∏è pour t&#39;aider √† t&#39;entra√Æner au d√©ploiement de tes projets web et √† l&#39;administration syst√®me. Ce serveur virtuel t&#39;est fourni avec un nom de domaine.</p></blockquote></details><p>üòâ Rends-toi sur la page d&#39;administration de ta VM Server Kourou, tu en auras besoin pour la suite de ce tutoriel : <a href="https://kourou.oclock.io/ressources/vm-cloud/" target="_blank" rel="noreferrer">https://kourou.oclock.io/ressources/vm-cloud/</a></p><blockquote><p>‚ÑπÔ∏è Certaines commandes de ce tutoriel te demanderont le mot de passe administrateur de ta VM Server Kourou, tu trouveras celui-ci sur la page d&#39;administration.</p></blockquote><h3 id="initialiser-la-vm" tabindex="-1">Initialiser la VM <a class="header-anchor" href="#initialiser-la-vm" aria-label="Permalink to &quot;Initialiser la VM&quot;">‚Äã</a></h3><details><summary>SPOILER: Premiers pas</summary><p>Si tu n&#39;as jamais utilis√© la VM Server Kourou ou si tu l&#39;as supprim√©e, clique sur le bouton &quot;Cr√©er la VM&quot;.</p><p>Pour repartir d&#39;une VM vierge, clique sur le bouton &quot;R√©installer la VM&quot;.</p><p>‚ö†Ô∏è Dans ces deux cas, tu devras cr√©er une nouvelle cl√© SSH sur la VM Server Kourou pour pouvoir cloner et pull le projet depuis GitHub. Tu trouveras la proc√©dure √† suivre dans la <a href="https://kourou.oclock.io/ressources/fiche-recap/git-et-github/#cr%c3%a9er-une-cl%c3%a9-ssh-pour-github" target="_blank" rel="noreferrer">fiche r√©cap d√©di√©e √† Git et GitHub</a>.</p></details><p>Si ta VM est d√©j√† pr√™te, clique sur &quot;D√©marrer la VM&quot;.</p><h3 id="se-connecter-a-la-vm" tabindex="-1">Se connecter √† la VM <a class="header-anchor" href="#se-connecter-a-la-vm" aria-label="Permalink to &quot;Se connecter √† la VM&quot;">‚Äã</a></h3><p>Une fois la VM Server d√©marr√©e, connecte-toi en SSH. Tu trouveras la commande √† utiliser dans ton terminal sur la page d&#39;administration de ta VM, elle devrait ressembler √† ceci :</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> student@pseudo-server.eddi.cloud</span></span></code></pre></div><p>‚ö†Ô∏è Tout le temps de ta connexion √† la VM, <strong><em>ne ferme surtout pas la page d&#39;administration</em></strong> car c&#39;est elle qui permet d&#39;autoriser la connexion depuis ton IP !</p><h2 id="etape-1-installer-l-environnement-de-production" tabindex="-1">√âtape 1 : Installer l&#39;environnement de production <a class="header-anchor" href="#etape-1-installer-l-environnement-de-production" aria-label="Permalink to &quot;√âtape 1 : Installer l&#39;environnement de production&quot;">‚Äã</a></h2><h3 id="installation-du-sgbdr-mariadb-mysql" tabindex="-1">Installation du SGBDR MariaDB (MySQL) <a class="header-anchor" href="#installation-du-sgbdr-mariadb-mysql" aria-label="Permalink to &quot;Installation du SGBDR MariaDB (MySQL)&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mariadb-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mariadb-client</span></span></code></pre></div><details><summary>SPOILER: D√©tail des commandes</summary><p>On commence par mettre √† jour les catalogues des logiciels disponibles sur le serveur (la commande <code>sudo</code> permet d&#39;excuter la commande avec les droits administrateur) :</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span></code></pre></div><p>Puis on installe les packages (logiciels) n√©cessaires pour g√©rer des bases de donn√©es sur le serveur :</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mariadb-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mariadb-client</span></span></code></pre></div><p>Ici, on a choisi d&#39;installer MariaDB qui est une version open source de MySQL. On a besoin du package <code>mariadb-server</code> pour avoir un serveur de bases de donn√©es, ainsi que des outils fournis par le package <code>mariadb-client</code> (notamment la commande <code>mysql</code>) pour interagir avec ces bases de donn√©es.</p><p>L&#39;option <code>-y</code> permet de dire au logiciel <code>apt</code> qui sert √† g√©rer les packages install√©s sur le syst√®me de ne pas demander confirmation pour installer les packages demand√©s.</p></details><h3 id="installation-de-apache" tabindex="-1">Installation de Apache <a class="header-anchor" href="#installation-de-apache" aria-label="Permalink to &quot;Installation de Apache&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache2</span></span></code></pre></div><details><summary>SPOILER: D√©tail de la commande</summary><p>On installe ici le serveur web Apache httpd, qui est un des plus utilis√©s dans les environnements de production √† l&#39;heure actuelle. On pourrait tout-√†-fait en installer un autre tel que Nginx ou Caddy.</p><p>Comme pr√©c√©demment, on utilise la commande <code>apt install</code> pour installer le paquet logiciel <code>apache2</code>. L&#39;option <code>-y</code> permet de ne pas avoir √† confirmer l&#39;installation a posteriori et la commande est lanc√©e avec les droits administrateur (<code>sudo</code>).</p><blockquote><p>ü§î <em><strong>Mais pourquoi a-t-on besoin d&#39;un serveur web ?</strong></em></p><p><em>En effet, Directus est fourni avec son propre serveur HTTP qui est fait et tourne avec Node.js, donc il n&#39;y a en th√©orie pas besoin d&#39;utiliser un autre serveur web pour acc√©der √† Directus une fois qu&#39;il est install√©‚Ä¶ Sauf que dans la pratique, on pr√©f√®re √©viter d&#39;utiliser un serveur Node.js comme serveur &quot;frontal&quot;.</em></p><p><em>Ici, on installe autre logiciel qui n&#39;est qu&#39;un serveur web et dont l&#39;unique r√¥le sera de recevoir les requ√™tes HTTP du client et de les passer au serveur de Directus (c&#39;est le principe d&#39;un serveur proxy). Cette technique permettra d&#39;avoir toujours un serveur HTTP qui r√©pond m√™me si le serveur de Directus a crash√©, et il sera beaucoup plus simple de configurer HTTPS sur ce proxy que sur le serveur Node.js de Directus.</em></p><p><em>Voici, en gros, l&#39;installation que ce tutoriel va te faire mettre en place :</em></p><div class="language-mermaid vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sequenceDiagram</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    participant C as Client (navigateur)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    participant A as Apache (proxy)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    participant D as Directus (Node.js)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    C -&gt;&gt; A: requ√™te HTTP</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    A --&gt;&gt; D: requ√™te HTTP</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    D --&gt;&gt; D: traitement</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    D --&gt;&gt; A: r√©ponse HTTP</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    A -&gt;&gt; C: r√©ponse HTTP</span></span></code></pre></div></blockquote></details><h3 id="installation-de-node-js" tabindex="-1">Installation de Node.js <a class="header-anchor" href="#installation-de-node-js" aria-label="Permalink to &quot;Installation de Node.js&quot;">‚Äã</a></h3><blockquote><p>‚ÑπÔ∏è Tu vas installer Node.js sur ta VM Server Kourou avec <a href="https://github.com/nvm-sh/nvm" target="_blank" rel="noreferrer">Node Version Manager</a>, un outil qui permet d&#39;installer et d&#39;utiliser rapidement n&#39;importe quelle version de Node. Ainsi, tu t&#39;assures que tu pourras ex√©cuter la version de Node.js la mieux adapt√©e √† ton application (Directus requiert actuellement la version 18 mais si tu utilises aussi Svelte, tu auras peut-√™tre besoin d&#39;une version plus r√©cente).</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o-</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> bash</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/.bashrc</span></span></code></pre></div><details><summary>SPOILER: D√©tail des commandes</summary><p>D&#39;abord, on t√©l√©charge le script d&#39;installation de NVM et on l&#39;ex√©cute avec l&#39;interpr√®te Bash (m√™me programme qui interpr√®te les commandes que tu entres dans ton terminal üòâ). Ce script va t√©l√©charger NVM, l&#39;installer dans le r√©pertoire personnel de l&#39;utilisateur actuel et ajouter l&#39;alias de commande <code>nvm</code> pour ce m√™me utilisateur.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o-</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> bash</span></span></code></pre></div><p>On dit √† l&#39;interpr√©teur Bash du terminal de recharger le fichier <code>.bashrc</code> de l&#39;utilisateur, car celui-ci contient notamment l&#39;alias de commande <code>nvm</code> qu&#39;on va devoir utiliser ensuite. Sans ce rechargement, il faudrait se d√©connecter et se reconnecter √† la VM pour avoir acc√®s √† la commande <code>nvm</code>.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/.bashrc</span></span></code></pre></div></details><h2 id="etape-2-installer-directus" tabindex="-1">√âtape 2 : Installer Directus <a class="header-anchor" href="#etape-2-installer-directus" aria-label="Permalink to &quot;√âtape 2 : Installer Directus&quot;">‚Äã</a></h2><h3 id="preparation-du-repertoire-d-installation" tabindex="-1">Pr√©paration du r√©pertoire d&#39;installation <a class="header-anchor" href="#preparation-du-repertoire-d-installation" aria-label="Permalink to &quot;Pr√©paration du r√©pertoire d&#39;installation&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> o+w</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www</span></span></code></pre></div><details><summary>SPOILER: D√©tails de la commande</summary><p>Tu vas installer Directus dans le r√©pertoire <code>/var/www</code>. Comme le r√©pertoire parent <code>/var</code> est prot√©g√© en √©criture, cette commande doit √™tre lanc√©e avec les droits administrateur (<code>sudo</code>).</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www</span></span></code></pre></div><p>Le r√©pertoire dans lequel tu vas installer Directus est un r√©pertoire prot√©g√© en √©criture, il faut donc te donner le droit d&#39;y modifier des fichiers et des dossiers.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> o+w</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www</span></span></code></pre></div><p>On peut d√©composer cette commande ainsi :</p><ul><li><code>sudo</code> - on ex√©cute la commande qui suit avec les droits administrateur</li><li><code>chmod</code> - commande qui permet de modifier les droits d&#39;une ressources (fichier ou r√©pertoire)</li><li><code>-R</code> - on indique que la modification s&#39;appliquera aussi aux fichiers et dossiers enfants, par <em>r√©cursivit√©</em></li><li><code>o+w</code> - il s&#39;agit de la modification des droits <ul><li><code>o</code> - on modifie les droits des &quot;autres utilisateurs&quot;, c&#39;est-√†-dire ceux qui ne sont pas propri√©taires de la ressource</li><li><code>+</code> - on indique qu&#39;on ajoute les droits qui suivent</li><li><code>w</code> - droit d&#39;√©criture (üá¨üáß <em>write</em> = üá´üá∑ <em>√©crire</em>)</li></ul></li><li><code>/var/www</code> - on sp√©cifie le chemin de la ressource dont on modifie les droits, ici c&#39;est le r√©pertoire <code>/var/www</code></li></ul><p>Cette commande-ci devrait t&#39;√™tre famili√®re, on ne fait que se placer dans un r√©pertoire pr√©cis :</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www</span></span></code></pre></div></details><h3 id="preparation-de-la-base-de-donnees" tabindex="-1">Pr√©paration de la base de donn√©es <a class="header-anchor" href="#preparation-de-la-base-de-donnees" aria-label="Permalink to &quot;Pr√©paration de la base de donn√©es&quot;">‚Äã</a></h3><p>Pour cr√©er et configurer la base de donn√©es, tu vas utiliser MySQL en ligne de commande :</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span></span></code></pre></div><details><summary>SPOILER: D√©tail de la commande</summary><p>On utilise ici la commande <code>mysql</code> fournie par notre installation du package <code>mariadb-client</code> pour se connecter au serveur de bases de donn√©es. L&#39;option <code>-u</code> permet d&#39;indiquer le nom de l&#39;utilisateur avec lequel on souhaite se connecter.</p><p>Comme notre installation de MariaDB/MySQL est &quot;fra√Æche&quot;, le serveur de bases de donn√©es ne comporte qu&#39;un seul utilisateur qui a tous les droits : <code>root</code>. Cependant, son utilisation est restreinte par d√©faut.</p><p>En effet, <code>root</code> ne peut se connecter que via le terminal et seulement si la commande <code>mysql</code> est utilis√©e avec les droits administrateur (via <code>sudo</code>). <strong>Tu ne pourras donc pas utiliser l&#39;utilisateur <code>root</code> pour te connecter √† ta base de donn√©es avec ton code !!!</strong></p></details><p>Tu devrais maintenant te trouver dans un shell MySQL, c&#39;est un peu comme le terminal de ton SGBDR √† l&#39;int√©rieur de ton terminal.</p><p>Cr√©e d&#39;abord la base de donn√©es <strong>(‚ö†Ô∏è <em>remplace <code>&lt;db&gt;</code> par le nom de ta BDD !!!</em>)</strong> :</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">db</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Cr√©e ensuite l&#39;utilisateur qui permettra √† ton code de se connecter √† ta base de donn√©es <strong>(‚ö†Ô∏è <em>remplace <code>&lt;user&gt;</code> par le nom de l&#39;utilisateur et <code>&lt;password&gt;</code> par son mot de passe !!!</em>)</strong> :</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> USER </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&lt;user&gt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;localhost&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&lt;password&gt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Donne les droits √† l&#39;utilisateur sur la base de donn√©es <strong>(‚ö†Ô∏è <em>remplace <code>&lt;db&gt;</code> par le nom de la BDD et <code>&lt;user&gt;</code> par le nom de l&#39;utilisateur !!!</em>)</strong> :</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">db</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&lt;user&gt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;localhost&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Recharge les droits :</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FLUSH PRIVILEGES;</span></span></code></pre></div><p>Sors du shell MySQL :</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EXIT;</span></span></code></pre></div><h3 id="installation-de-directus" tabindex="-1">Installation de Directus <a class="header-anchor" href="#installation-de-directus" aria-label="Permalink to &quot;Installation de Directus&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nvm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 18</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> init</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directus-project@latest</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directus.site</span></span></code></pre></div><details><summary>SPOILER: D√©tail de la commande</summary><p>Tout d&#39;abord, on fait appel √† <code>nvm exec</code> pour ex√©cuter une commande avec une version sp√©cifique de Node.js (ici, la version 18). Ceci vient du fait que Directus requiert absolument la version 18 de Node.js, il ne tol√®re aucune autre version, mais il est possible que tu aies d&#39;autres projets (avec Svelte, notamment) qui n√©cessitent une version plus r√©cente. NVM te permet donc d&#39;utiliser la Node.js 18 pour installer Directus, tout en restant sur ta version plus r√©cente de Node.js pour les autres choses.</p><p>On utilise NPM pour t√©l√©charger le package Node <code>directus-project</code> qui permet d&#39;initialiser un nouveau projet Directus. En lui donnant un nom de r√©pertoire, on dit au package d&#39;initialiser le projet dans ce r√©pertoire sp√©cifiquement (ici <code>directus.site</code>).</p><p>La commande cr√©era donc une nouvelle installation de Directus dans le r√©pertoire <code>/var/www/directus.site</code>.</p></details><p>R√©ponds aux diff√©rentes questions dans le terminal pour configurer ton installation de Directus :</p><blockquote><p><code>Choose your database client</code></p><p><em>S√©lectionne <code>MySQL / MariaDB / Aurora</code> avec les fl√®ches de ton clavier, puis valide ton choix avec <code>Entr√©e</code>.</em></p></blockquote><blockquote><p><code>Database Host: (127.0.0.1)</code></p><p><em>Appuie simplment sur la touche <code>Entr√©e</code> pour valider <code>127.0.0.1</code> comme adresse de ton SGBDR.</em></p></blockquote><blockquote><p><code>Port: (3306)</code></p><p><em>Appuie simplement sur la touche <code>Entr√©e</code> pour valider <code>3306</code> comme port de connexion √† ton SGBDR.</em></p></blockquote><blockquote><p><code>Database Name: (directus)</code></p><p><em>Entre le nom que tu as donn√© √† la BDD que tu as cr√©√©e pr√©c√©demment (requ√™te SQL <code>CREATE DATABASE</code>), puis valide avec <code>Entr√©e</code>.</em></p></blockquote><blockquote><p><code>Database User:</code></p><p><em>Entre le nom de l&#39;utilisateur de BDD que tu as cr√©√© pr√©c√©demment (requ√™te SQL <code>CREATE USER</code>), puis valide avec <code>Entr√©e</code>.</em></p></blockquote><blockquote><p><code>Database Password:</code></p><p><em>Entre le mot de passe de l&#39;utilisateur de BDD que tu as cr√©√© pr√©c√©demment (requ√™te SQL <code>CREATE USER</code>), puis valide avec <code>Entr√©e</code>.</em></p></blockquote><blockquote><p><code>Email (admin@example.com)</code></p><p><em>Entre l&#39;adresse e-mail que tu souhaites donne au compte du super admin par d√©faut, puis valide avec <code>Entr√©e</code>.</em></p></blockquote><blockquote><p><code>Password</code></p><p><em>Entre le mot de passe que tu souhaites utliser pour le compte du super admin par d√©faut, puis valide avec <code>Entr√©e</code> <strong>APR√àS AVOIR NOT√â CE MOT DE PASSE EN LIEU S√õR</strong>.</em></p></blockquote><p>Voil√†, Directus est install√© ! Mais il n&#39;est pas encore op√©rationnel‚Ä¶</p><h2 id="etape-3-preparer-le-serveur-directus" tabindex="-1">√âtape 3 : Pr√©parer le serveur Directus <a class="header-anchor" href="#etape-3-preparer-le-serveur-directus" aria-label="Permalink to &quot;√âtape 3 : Pr√©parer le serveur Directus&quot;">‚Äã</a></h2><h3 id="configurer-le-service-directus" tabindex="-1">Configurer le service Directus <a class="header-anchor" href="#configurer-le-service-directus" aria-label="Permalink to &quot;Configurer le service Directus&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;[Unit]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Description=Directus Service</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Requires=mariadb.service</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">After=mariadb.service</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">User=student</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Group=student</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Restart=always</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">WorkingDirectory=/var/www/directus.site</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Environment=NODE_VERSION=18</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ExecStart=/home/student/.nvm/nvm-exec npx -y directus start</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">WantedBy=multi-user.target</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tee</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/systemd/system/directus.service</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/null</span></span></code></pre></div><details><summary>SPOILER: D√©tail de la commande</summary><p>La commande <code>echo</code> permet de fournir une cha√Æne de texte au terminal. Ici, la cha√Æne en question est le contenu du fichier de configuration du service qui se chargera de lancer Directus √† notre place. Gr√¢ce √† la syntaxe du <em>pipe</em> (<code>|</code>), on dit au terminal d&#39;utiliser ce texte comme argument de la commande <code>tee</code> qui permet, avec l&#39;option <code>-a</code> d&#39;ajouter le contenu dans le fichier dont on lui donne le chemin (ici <code>/etc/systemd/system/directus.service</code>).</p><p>En r√©sum√©, on cr√©e ce fichier et on lui injecte la configuration d&#39;un service Linux comme contenu. On doit ex√©cuter la commande <code>tee</code> avec les droits administrateurs (<code>sudo</code>) car on touche ici aux fichiers du syst√®me. La redirection de l&#39;affichage du terminal vers <code>&gt; /dev/null</code> sert juste √† ne pas afficher le retour de la commande <code>tee</code> qui r√©p√®terait juste le texte mis dans le fichier.</p></details><details><summary>SPOILER: D√©tail du service</summary><p>Le contenu du fichier <code>/etc/systemd/system/directus.service</code> est la configuration d&#39;un service Linux. Un service, c&#39;est un programme que le syst√®me d&#39;exploitation va pouvoir lancer en arri√®re-plan de mani√®re automatis√©e, et relancer en cas de souci. Par exemple, quand tu as install√© le serveur Apache, un service <code>apache2</code> a √©t√© cr√©√© ; ici, c&#39;est un service <code>directus</code> qu&#39;on est en train de cr√©er nous-m√™mes !</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[Unit]</span></span>
<span class="line"><span>Description=Directus Service</span></span>
<span class="line"><span>Requires=mariadb.service</span></span>
<span class="line"><span>After=mariadb.service</span></span></code></pre></div><p>Cette premi√®re section permet de d√©crire un peu ton service. On y indique une br√®ve description, mais surtout on pr√©cise qu&#39;il a besoin que le service <code>mariadb</code> (ton serveur de bases de donn√©es) doit √™tre en train de tourner - ben oui, essaie d&#39;utiliser Directus sans base de donn√©es, pour voir ? üòÜ</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[Service]</span></span>
<span class="line"><span>User=student</span></span>
<span class="line"><span>Group=student</span></span>
<span class="line"><span>Restart=always</span></span>
<span class="line"><span>WorkingDirectory=/var/www/directus.site</span></span>
<span class="line"><span>Environment=NODE_VERSION=18</span></span>
<span class="line"><span>ExecStart=/home/student/.nvm/nvm-exec npx -y directus start</span></span></code></pre></div><p>Dans la section <code>Service</code>, on d√©crit dans quelles conditions le syst√®me doit lancer le service et comment il doit le faire :</p><ul><li><code>User</code> d√©finit que le syst√®me doit ex√©cuter le programme du service en tant que l&#39;utilisateur <code>student</code> (c&#39;est toi üòâ)</li><li><code>Group</code> indique que le groupe utilis√© pour l&#39;ex√©cution du service est aussi le groupe <code>student</code> ; en combinaison avec <code>User</code>, cette directive assure notamment que l&#39;utilisateur <code>student</code> aura tous les droits n√©cessaires pour manipuler les fichiers enregistr√©s dans le r√©pertoire <code>/var/www/directus.site</code></li><li><code>Restart</code> permet de dire au syst√®me comment r√©agir dans le cas o√π le programme du service s&#39;arr√™terait de lui-m√™me (ce qui peut arriver en cas d&#39;erreur, par exemple) ; ici, <code>always</code> indique que le syst√®me doit obligatoirement tenter de red√©marrer le programme d√®s qu&#39;il s&#39;arr√™te tout seul</li><li><code>WorkingDirectory</code> sp√©cifie le r√©pertoire √† partir duquel lancer le programme du service ; dans ton cas, il faut que ce soit le r√©pertoire de l&#39;installation de Directus pour que le serveur de Directus puisse bien d√©marrer</li><li><code>Environment</code> sert √† donner des informations additionnelles √† la commande qui lancera le programme du service ; ici, va forcer l&#39;utilisation de la version 18 de Node.js car Directus ne supporte pas de version plus r√©cente</li><li><code>ExecStart</code> donne la commande que le syst√®me doit ex√©cuter pour lancer le programme du service ; on utilise ici l&#39;ex√©cutable <code>nvm-exec</code> fourni avec Node Version Manager pour s&#39;assurer que le serveur Directus sera lanc√© avec la version de Node.js donn√©e par la variable d&#39;environnement <code>NODE_VERSION</code> donn√©e dans la directive <code>Environment</code> ; la commande qui lance le serveur, elle, tu la connais, c&#39;est <code>npx directus start</code> (avec l&#39;option <code>-y</code> qui permet d&#39;installer automatiquement le module <code>directus</code> s&#39;il ne l&#39;est pas encore)</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[Install]</span></span>
<span class="line"><span>WantedBy=multi-user.target</span></span></code></pre></div><p>Enfin, cette derni√®re section permet d&#39;indiquer au syst√®me √† quel moment il doit d√©marrer le service dans le cadre d&#39;une ex√©cution automatique. La valeur <code>multi-user.target</code> fera en sorte que le service sera lanc√© d√®s que les utilisateurs pourront s&#39;identifier dans le syst√®me via un terminal - en gros, d√®s que le syst√®me sera pr√™t.</p></details><h3 id="demarrer-le-service" tabindex="-1">D√©marrer le service <a class="header-anchor" href="#demarrer-le-service" aria-label="Permalink to &quot;D√©marrer le service&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directus.service</span></span></code></pre></div><details><summary>SPOILER: D√©tail de la commande</summary><p>La commande <code>systemctl</code> permet d&#39;interagir avec les service Linux. La sous-commande <code>start</code>, elle, sert √† d√©marrer un service (ici <code>directus</code>).</p><p>Comme on agit sur l&#39;ex√©cution de programmes au niveau du syst√®me, on ex√©cute cette commande avec les droits administrateur (<code>sudo</code>).</p><blockquote><p>‚ÑπÔ∏è <strong>Interagir avec ton service</strong></p><p>√Ä tout moment tu peux v√©rifier si ton service est en cours d&#39;ex√©cution avec cette commande (pas besoin des droits administrateur) :</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directus.service</span></span></code></pre></div><p>Tu peux aussi consulter les logs du service avec cette commande :</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">journalctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directus.service</span></span></code></pre></div><p>Tu peux aussi arr√™ter le service ainsi (droits administrateur requis) :</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directus.service</span></span></code></pre></div></blockquote></details><h3 id="activer-le-demarrage-automatique-du-service" tabindex="-1">Activer le d√©marrage automatique du service <a class="header-anchor" href="#activer-le-demarrage-automatique-du-service" aria-label="Permalink to &quot;Activer le d√©marrage automatique du service&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directus.service</span></span></code></pre></div><details><summary>SPOILER: D√©tail de la commande</summary><p>La sous-commande <code>enable</code> de <code>systemctl</code> permet de dire au syst√®me d&#39;exploitation de lancer un service au d√©marrage. Ici, √† partir du prochain d√©marrage ou red√©marrage de ta VM Server, le service <code>directus</code> sera lanc√© automatiquement et tu n&#39;auras pas √† le lancer toi-m√™me.</p><blockquote><p>‚ÑπÔ∏è Tu peux dire au syst√®me d&#39;arr√™ter de lancer ton service au d√©marrage avec la commande suivante :</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directus.service</span></span></code></pre></div></blockquote></details><p>‚ö†Ô∏è Le lancement automatique du service ne prendra effet qu&#39;√† partir du prochain d√©marrage du syst√®me, tu dois donc lancer toi-m√™me ton service avec <code>susdo systemctl start directus.service</code> pour cette fois.</p><h2 id="etape-4-configurer-le-proxy-apache" tabindex="-1">√âtape 4 : Configurer le proxy Apache <a class="header-anchor" href="#etape-4-configurer-le-proxy-apache" aria-label="Permalink to &quot;√âtape 4 : Configurer le proxy Apache&quot;">‚Äã</a></h2><h3 id="utilisation-des-ports-8080-et-8443" tabindex="-1">Utilisation des ports 8080 et 8443 <a class="header-anchor" href="#utilisation-des-ports-8080-et-8443" aria-label="Permalink to &quot;Utilisation des ports 8080 et 8443&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s#Listen 80#Listen 80\n\tListen 8080#g&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apache2/ports.conf</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s#Listen 443#Listen 443\n\tListen 8443#g&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apache2/ports.conf</span></span></code></pre></div><details><summary>SPOILER: D√©tail des commandes</summary><p>J&#39;avoue, ces deux commandes sont carr√©ment barbares üßå et, entre nous, franchement pas jolies ü´†</p><p>Par d√©faut, le serveur Apache utilise le port 80 pour recevoir les requ√™tes HTTP, et le port 443 pour les requ√™tes en HTTPS. Ces deux ports sont les ports standard du protocole HTTP.</p><p>Sauf que toi, tu dois faire en sorte que Directus et son API soient accessibles sur les ports 8080 en HTTP et 8443 en HTTPS pour ne pas entrer en conflit avec ton front-end qui utilisera tr√®s s√ªrement les ports 80 et 443.</p><p>Ces deux commandes viennent simplement ajouter les ports 8080 et 8443 dans la liste des ports qui doivent √™tre √©cout√©s par Apache.</p></details><h3 id="activation-du-module-proxy-d-apache" tabindex="-1">Activation du module proxy d&#39;Apache <a class="header-anchor" href="#activation-du-module-proxy-d-apache" aria-label="Permalink to &quot;Activation du module proxy d&#39;Apache&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a2enmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> proxy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> proxy_http</span></span></code></pre></div><details><summary>SPOILER: D√©tail de la commande</summary><p>Par d√©faut, Apache ne sait pas comment se comporter en tant que serveur proxy. Il faut donc activer certains de ses modules avec la commande <code>a2enmod</code> (avec les droits administrateurs) pour le lui permettre :</p><ul><li>Le module <code>proxy</code> lui permet de reconna√Ætre les directives de configuration qui d√©crivent un comportement en tant que proxy</li><li>Le module <code>proxy_http</code> permet √† Apache de se comporter comme serveur proxy en dialoguant avec le serveur final via le protocole HTTP (√ßa tombe bien, le serveur Directus &quot;parle&quot; HTTP üòâ)</li></ul></details><h3 id="definition-du-virtual-host-pour-le-proxy" tabindex="-1">D√©finition du virtual host pour le proxy <a class="header-anchor" href="#definition-du-virtual-host-pour-le-proxy" aria-label="Permalink to &quot;D√©finition du virtual host pour le proxy&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&lt;VirtualHost *:8080&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    ProxyPreserveHost On</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    ProxyPass / http://localhost:8055/</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    ProxyPassReverse / http://localhost:8055/</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;/VirtualHost&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tee</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apache2/sites-available/directus.conf</span></span></code></pre></div><details><summary>SPOILER: D√©tail de la commande</summary><p>Afin qu&#39;Apache nous donne acc√®s √† Directus via le port 8080, il est n√©cessaire de lui sp√©cifier qu&#39;il doit se comporter comme proxy <strong>uniquement</strong> lorsqu&#39;il re√ßoit une requ√™te sur ce port.</p><p>Pour ce faire, on configure un <em>virutal host</em>, c&#39;est-√†-dire un &quot;site&quot;, pour indiquer √† Apache comment il doit se comporter dans un cas pr√©cis :</p><ul><li><code>&lt;VirtualHost *:8080&gt;</code> indique le d√©but d&#39;une section de configuration de type &quot;virtual host&quot; ; Apache devra appliquer les directives de configuration de cette section √† chaque fois qu&#39;il recevra une requ√™te HTTP sur le port 8080</li><li>Les directives <code>ProxyPreserveHost</code>, <code>ProxyPass</code> et <code>ProxyPassReverse</code> servent √† configurer le proxy en indiquant que les requ√™tes HTTP doivent √™tre &quot;transmisent&quot; au serveur HTTP qui tourne √† l&#39;adresse <code>http://localhost:8055/</code> (c&#39;est ton serveur Directus ! üòÑ)</li></ul></details><h3 id="activation-du-virtual-host" tabindex="-1">Activation du virtual host <a class="header-anchor" href="#activation-du-virtual-host" aria-label="Permalink to &quot;Activation du virtual host&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a2ensite</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directus.conf</span></span></code></pre></div><details><summary>SPOILER: D√©tail de la commande</summary><p>De la m√™me mani√®re que la commande <code>a2enmod</code> est un utilitaire pour activer des modules d&#39;Apache, <code>a2ensite</code> permet d&#39;activer des &quot;sites&quot; (virtual hosts). Ici, tu actives le virtual host que tu viens de cr√©er pour ton installation de Directus.</p></details><h3 id="redemarrage-du-serveur-apache" tabindex="-1">Red√©marrage du serveur Apache <a class="header-anchor" href="#redemarrage-du-serveur-apache" aria-label="Permalink to &quot;Red√©marrage du serveur Apache&quot;">‚Äã</a></h3><p>Red√©marre enfin le serveur Apache pour qu&#39;il prenne en compte toutes tes modifications :</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache2</span></span></code></pre></div><h2 id="etape-5-contempler-le-fruit-de-son-travail-ü§©" tabindex="-1">√âtape 5 : Contempler le fruit de son travail ü§© <a class="header-anchor" href="#etape-5-contempler-le-fruit-de-son-travail-ü§©" aria-label="Permalink to &quot;√âtape 5 : Contempler le fruit de son travail ü§©&quot;">‚Äã</a></h2><p>Voil√†, tu dois normalement pouvoir acc√©der √† ton Directus d√©ploy√© sur <code>http://&lt;pseudo&gt;-server.eddi.cloud:8080</code>, pour toi et pour le reste du monde !</p><p>Alors, content¬∑e ?</p><p>Directus se lancera sur ta VM √† chaque fois que tu la d√©marreras ou red√©marreras. Pense √† mettre √† jour l&#39;URL dans ton front-end, surtout en production !</p><h2 id="etape-6-bonus-installer-adminer-pour-administrer-la-bdd" tabindex="-1">√âtape 6 (bonus) : Installer Adminer pour administrer la BDD <a class="header-anchor" href="#etape-6-bonus-installer-adminer-pour-administrer-la-bdd" aria-label="Permalink to &quot;√âtape 6 (bonus) : Installer Adminer pour administrer la BDD&quot;">‚Äã</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> adminer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a2enconf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> adminer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache2</span></span></code></pre></div><p>Adminer est accessible sur <code>http://&lt;pseudo&gt;-server.eddi.cloud/adminer</code> et tu peux te connecter √† la base de donn√©es de Directus avec l&#39;utilisateur que tu as cr√©√© plus haut dans ce tutoriel (et son mot de passe üòâ) ! üéâ</p><h2 id="etape-7-bonus-mettre-en-place-https-pour-directus" tabindex="-1">√âtape 7 (bonus) : Mettre en place HTTPS pour Directus <a class="header-anchor" href="#etape-7-bonus-mettre-en-place-https-pour-directus" aria-label="Permalink to &quot;√âtape 7 (bonus) : Mettre en place HTTPS pour Directus&quot;">‚Äã</a></h2><p>‚ö†Ô∏è Cette section part du principe que tu as d√©j√† suivi le tutoriel pour <a href="./deploy-https.html">passer une application en HTTPS</a> et que tu as fait g√©n√©rer √† Certbot la configuration Apache pour le virtual host par d√©faut (fichiers <code>000-default.conf</code> et <code>000-default-le-ssl.conf</code>).</p><h3 id="configuration-du-virtual-host-en-https" tabindex="-1">Configuration du virtual host en HTTPS <a class="header-anchor" href="#configuration-du-virtual-host-en-https" aria-label="Permalink to &quot;Configuration du virtual host en HTTPS&quot;">‚Äã</a></h3><p>‚ö†Ô∏è Dans la commande suivante, <strong>remplace bien toutes les occurrences de <code>&lt;pseudo&gt;</code> par ton pseudo GitHub avant de valider</strong> !!!</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&lt;VirtualHost *:8443&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    Include /etc/letsencrypt/options-ssl-apache.conf</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    SSLCertificateFile /etc/letsencrypt/live/&lt;pseudo&gt;-server.eddi.cloud/fullchain.pem</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    SSLCertificateKeyFile /etc/letsencrypt/live/&lt;pseudo&gt;-oclock-server.eddi.cloud/privkey.pem</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    ProxyPreserveHost On</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    ProxyPass / http://localhost:8055/</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    ProxyPassReverse / http://localhost:8055/</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;/VirtualHost&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tee</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apache2/sites-available/directus-le-ssl.conf</span></span></code></pre></div><h3 id="configuration-de-la-redirection-automatique-de-http-vers-https" tabindex="-1">Configuration de la redirection automatique de HTTP vers HTTPS <a class="header-anchor" href="#configuration-de-la-redirection-automatique-de-http-vers-https" aria-label="Permalink to &quot;Configuration de la redirection automatique de HTTP vers HTTPS&quot;">‚Äã</a></h3><p>Pour forcer la s√©curit√©, on met souvent en place une redirection qui oblige les clients qui tente de communiquer avec le serveur en HTTP √† utiliser HTTPS.</p><p>‚ö†Ô∏è Dans la commande suivante, <strong>remplace bien toutes les occurrences de <code>&lt;pseudo&gt;</code> par ton pseudo GitHub avant de valider</strong> !!!</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&lt;VirtualHost *:8080&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    RewriteEngine on</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    RewriteCond %{SERVER_NAME} =&lt;pseudo&gt;-oclock-server.eddi.cloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    RewriteRule ^ https://%{SERVER_NAME}:8443%{REQUEST_URI} [END,NE,R=permanent]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;/VirtualHost&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tee</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apache2/sites-available/directus.conf</span></span></code></pre></div><h3 id="activation-du-virtual-host-https" tabindex="-1">Activation du virtual host HTTPS <a class="header-anchor" href="#activation-du-virtual-host-https" aria-label="Permalink to &quot;Activation du virtual host HTTPS&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a2ensite</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directus-le-ssl.conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache2</span></span></code></pre></div><h3 id="termine-üçæ" tabindex="-1">Termin√© ! üçæ <a class="header-anchor" href="#termine-üçæ" aria-label="Permalink to &quot;Termin√© ! üçæ&quot;">‚Äã</a></h3><p>Et voil√†, tu dois normalement pouvoir acc√©der √† Directus en HTTPS via <code>https://&lt;pseudo&gt;-server.eddi.cloud:8443</code> ! Et √ßa fonctionne aussi pour son API, bien √©videmment ! ü§∏</p><p>En plus, si tu te rends sur <code>http://&lt;pseudo&gt;-server.eddi.cloud:8080</code>, tu devrais √™tre automatiquement redirig√© vers la version en HTTPS üëå</p><p>üîí On est pas bien, l√†, avec la s√©curit√© ?</p></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><!----></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/markdown-examples.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Next page</span><span class="title" data-v-1bcd8184>Markdown Examples</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api-examples.md\":\"EODof_u0\",\"baptiste_02-deploiement-site-statique.md\":\"bRyYESc4\",\"baptiste_03-virtual-hosts.md\":\"s2nWyQJx\",\"baptiste_04-deploiement-app-laravel.md\":\"B9FJRNs6\",\"baptiste_05-docker-install.md\":\"DpfQEWEY\",\"baptiste_06-docker-commandes-basiques.md\":\"4BP_Dy6g\",\"baptiste_07-docker-bind-mounts.md\":\"BA9u-L-6\",\"baptiste_08-docker-exec.md\":\"Hy1z3yZF\",\"baptiste_09-dockerfile.md\":\"D_x65KW9\",\"baptiste_10-docker-compose.md\":\"BHBuKYkq\",\"baptiste_11-docker-production.md\":\"Cb0jlwEK\",\"baptiste_12-orchestration.md\":\"Bfh-wT5Q\",\"baptiste_accessib_baptiste.md\":\"CxxPi8Z-\",\"baptiste_guide-images_accessib_baptiste.md\":\"BbfL_qGf\",\"baptiste_seo.md\":\"CsjTt59P\",\"cecile_e03_vers-react.md\":\"6_HYltbX\",\"cecile_e12_recap-react.md\":\"CndcJJLW\",\"cecile_e16_recap-redux.md\":\"r_OpEhvx\",\"cecile_e18_tests.md\":\"BCROcXU0\",\"cecile_e19_authentification.md\":\"8ShxDR-C\",\"cecile_e20_ouvertures.md\":\"BFcH5MXw\",\"cicd_ci-cd-definitions.md\":\"DOxgj-fP\",\"cicd_ci-cd-index.md\":\"CLhn-kJO\",\"cicd_ci-cd-runner-gitlab.md\":\"B7Rlr_Uf\",\"cicd_tips_pour_deployer_avec_un_runner.md\":\"CBBdh3_I\",\"index.md\":\"D7zM3ZcW\",\"laravel_blade.md\":\"HRjyxKB8\",\"laravel_controllers.md\":\"BokSgoPj\",\"laravel_dossiers.md\":\"D08czA2y\",\"laravel_fonctionnalites.md\":\"1dn2Uarl\",\"laravel_install.md\":\"X65xVHmc\",\"laravel_models.md\":\"BGhmoq5u\",\"laravel_routes.md\":\"DdEk3091\",\"laure_install_php-vanilla.md\":\"CoO4cfNb\",\"laure_notions_dw.md\":\"C6RQwMTD\",\"laure_wp.md\":\"CX2xFRgO\",\"les_autres.md\":\"CNZIsk8S\",\"loic_deploy-directus.md\":\"tgP4OCcd\",\"loic_deploy-https.md\":\"DtK62a7K\",\"loic_deploy-symfony.md\":\"BC6TfUVc\",\"loic_deploy-vite-spa.md\":\"DS_J6Bg7\",\"markdown-examples.md\":\"CV1SgZx1\",\"menus_baptiste.md\":\"C7H6p5jR\",\"menus_cecile.md\":\"CrrpPiHd\",\"menus_cicd.md\":\"DE4TI8gR\",\"menus_laravel.md\":\"aL17LXsi\",\"menus_les_autres.md\":\"CCmJrgsy\",\"menus_loic.md\":\"Bkt67_DW\",\"menus_mep.md\":\"CIXNB1Ua\",\"menus_symfony.md\":\"CzOja-yD\",\"mep_mise-en-prod-symfony.md\":\"B-7BvnFm\",\"mep_mise_en_prod_symfony_web_encore.md\":\"C1p99Ii_\",\"symfony_api_with_symfony.md\":\"kn-2kvIf\",\"symfony_mise-en-prod-symfony.md\":\"CD1_bIjg\",\"symfony_mise_en_prod_symfony_web_encore.md\":\"DPXKbiS1\",\"symfony_symfony_from_scratch.md\":\"BMzYsdNg\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Fiches Dev Web\",\"description\":\"Dev Web tutorials\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/index\"},{\"text\":\"Feat.\",\"link\":\"/menus/les_autres\"},{\"text\":\"Examples\",\"link\":\"/markdown-examples\"}],\"sidebar\":[{\"text\":\"Examples\",\"items\":[{\"text\":\"Markdown Examples\",\"link\":\"/markdown-examples\"},{\"text\":\"Runtime API Examples\",\"link\":\"/api-examples\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/lorlor31\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>